#!/usr/bin/env ruby

# frozen_string_literal: true

#
# Tic Tac Toe Game
#
require 'colorize'
require_relative '../lib/player.rb'
require_relative '../lib/board.rb'

def switch_player
  if $current_player == $player1
    $current_player = $plyaer2
  else
    $current_player = $player1
  end
end

$board = Board.new

$player1 = Player.new('Player 1', 'X')
$plyaer2 = Player.new('Player 2', 'O')

$current_player = $player2

$valid_choice = true
$num_choice = 1

$i = -1

while $i == -1
  $board.print_board

  switch_player if $valid_choice == true

  puts "\n\n#{$current_player.name}, enter a number: ".blue

  $valid_choice = $board.get_choice(gets.chomp.to_i, $current_player.mark)

  if $valid_choice == false
    puts "Invalid move. Press Enter to continue..."
    gets
  end

  if $board.check_horizontal1
    $i = 1
  elsif $board.check_horizontal2
    $i = 1
  elsif $board.check_horizontal3
    $i = 1
  elsif $board.check_vertical1
    $i = 1
  elsif $board.check_vertical2
    $i = 1
  elsif $board.check_vertical3
    $i = 1
  elsif $board.check_diagonal1
    $i = 1
  elsif $board.check_diagonal2
    $i = 1
  elsif $board.check_draw($num_choice)
    $i = 0
  else
    $i = -1
    $num_choice += 1
  end
end

$board.print_board

if $i == 1
  puts "\n\n* * * * * * * * * * * * * *"
  puts "* * *  #{$current_player.name} win   * * *"
  puts "* * * * * * * * * * * * * *"
else
  puts "\n\n* * * * * * * * * * * * *"
  puts "* * *   Game draw   * * *"
  puts "* * * * * * * * * * * * *"
end
